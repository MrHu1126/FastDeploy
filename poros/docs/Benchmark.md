# Benchmark
## Environment
This benchmark is tested on CentOS7 with GPU `A10` and CPU `Intel(R) Xeon(R) Platinum 8350C CPU @ 2.60GHz`, and its environment is as follows:
| Package  |  Version |
|----------|----------|
| CUDA     | 11.3     |
| cuDNN    | 8.3.2.44 |
| TensorRT | 8.4.1.5  |
| Python   | 3.8.13   |
| PyTorch  | 1.12.1   |

## 1. ResNet50
Input shape: bx3x224x224
| Batch size | PyTorch (ms) |  Poros (ms) |
|------------|--------------|-------------|
| 1          |   4.44       |  1.70       |
| 2          |   4.47       |  2.41       |
| 4          |   5.37       |  3.23       |
| 8          |   8.39       |  4.75       |
| 16         |   16.16      |  7.82       |
| 32         |   32.29      |  14.00      |

## 2. VGG16
Input shape: bx3x224x224
| Batch size | PyTorch (ms) |  Poros (ms) |
|------------|--------------|-------------|
| 1          |   3.15       |  2.71       |
| 2          |   4.93       |  3.78       |
| 4          |   8.13       |  6.09       |
| 8          |   14.67      |  10.20      |
| 16         |   27.56      |  19.17      |
| 32         |   52.74      |  36.47      |

## 3. MobileNetV2
Input shape: bx3x224x224
| Batch size | PyTorch (ms) |  Poros (ms) |
|------------|--------------|-------------|
| 1          |   3.54       |  0.65       |
| 2          |   3.42       |  0.86       |
| 4          |   3.08       |  1.19       |
| 8          |   4.26       |  2.08       |
| 16         |   8.35       |  3.83       |
| 32         |   16.55      |  7.14       |

## 4. InceptionV3
Input shape: bx3x224x224
| Batch size | PyTorch (ms) |  Poros (ms) |
|------------|--------------|-------------|
| 1          |   6.45       |  2.51       |
| 2          |   6.55       |  3.22       |
| 4          |   6.46       |  3.70       |
| 8          |   6.61       |  4.95       |
| 16         |   10.91      |  7.11       |
| 32         |   18.20      |  11.22      |

## 5. Efficientnet_b0
Input shape: bx3x224x224
| Batch size | PyTorch (ms) |  Poros (ms) |
|------------|--------------|-------------|
| 1          |   5.20       |  1.28       |
| 2          |   5.39       |  1.57       |
| 4          |   5.93       |  2.29       |
| 8          |   5.47       |  3.65       |
| 16         |   8.60       |  6.62       |
| 32         |   16.88      |  12.51      |

## 6. Bert-base
Input shape: bx128
| Batch size | PyTorch (ms) |  Poros (ms) |
|------------|--------------|-------------|
| 1          |   4.27       |  2.02       |
| 2          |   6.86       |  2.59       |
| 4          |   11.32      |  4.39       |
| 8          |   21.14      |  8.41       |
| 16         |   42.77      |  16.90      |
| 32         |   85.99      |  32.21      |

## 7. Vision Transformer (ViT)
Input shape: bx3x224x224
| Batch size | PyTorch (ms) |  Poros (ms) |
|------------|--------------|-------------|
| 1          |   5.84       |  3.07       |
| 2          |   10.17      |  4.57       |
| 4          |   18.36      |  8.37       |
| 8          |   34.90      |  16.34      |
| 16         |   68.67      |  29.92      |
| 32         |   137.06     |  58.11      |

## 8. YOLOv5s
Input shape: bx3x640x640
| Batch size | PyTorch (ms) |  Poros (ms) |
|------------|--------------|-------------|
| 1          |   4.98       |  2.22       |
| 2          |   6.38       |  3.96       |
| 4          |   12.20      |  6.84       |
| 8          |   24.72      |  12.86      |
| 16         |   47.86      |  24.80      |
| 32         |   97.45      |  49.16      |

## 9. Swin Transformer
Input shape: bx3x224x224
| Batch size | PyTorch (ms) |  Poros (ms) |
|------------|--------------|-------------|
| 1          |   13.56      |  7.68       |
| 2          |   22.56      |  11.99      |
| 4          |   41.36      |  21.74      |
| 8          |   80.51      |  42.18      |
| 16         |   156.62     |  78.34      |
| 32         |   314.74     |  149.72     |